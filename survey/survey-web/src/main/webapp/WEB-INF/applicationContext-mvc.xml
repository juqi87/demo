<?xml version="1.0"  encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:mvc="http://www.springframework.org/schema/mvc" 
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
						http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
				        http://www.springframework.org/schema/context 
				        http://www.springframework.org/schema/context/spring-context.xsd
				        http://www.springframework.org/schema/mvc
				        http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">
       
	<!-- SpringMVC配置 -->
	<!-- 通过component-scan让Spring扫描com.jq.survey.web下的所有的类，让Spring的代码注解生效 -->
	<context:component-scan base-package="com.jq.survey.web"></context:component-scan>
	
	<!-- 默认的注解映射的支持 -->  
	<mvc:annotation-driven />
	<!-- 如果当前路径是/index 则交给相应的视图解析器直接解析为视图 -->
	<mvc:view-controller path="/index" view-name="index" />
	<!-- 访问静态资源  匹配/static/**的URL被当做静态资源,由Spring读出到内存中再响应http --> 
	<!-- cache-period可以使得静态资源进行web cache 强制每次请求直接发送给源服务器，
		  而不经过本地缓存版本的校验。这对于需要确认认证应用很有用(可以和public结合使用),
		  或者严格要求使用最新数据的应用（不惜牺牲使用缓存的所有好处）-->
	<mvc:resources mapping="/static/**" location="/static/" cache-period="31556926"/>
	<bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping">
		<property name="interceptors">
			<list>
				<bean class="com.jq.survey.web.interceptor.LoginInterceptor"></bean>
			</list>
		</property>
	</bean>
	
	
	<!-- InternalResourceViewResolver 国际化视图解析器 -->
	<!-- 配置SpringMVC的视图渲染器， 让其前缀为:/WEB-INF/view/ 后缀为.jsp 将视图渲染到/page/<method返回值>.jsp中 -->
	<!--
	<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
		<property name="prefix" value="/WEB-INF/view/" />
		<property name="suffix" value=".jsp" />
	</bean>
	-->
	
	<!-- FreeMarkerViewResolver FreeMarker视图解析器 -->
	<bean id="viewResolver"
		class="org.springframework.web.servlet.view.freemarker.FreeMarkerViewResolver">
		<property name="exposeSpringMacroHelpers" value="true" />
		<property name="exposeRequestAttributes" value="true" />
		<property name="requestContextAttribute" value="rc" />
		<property name="prefix" value="/" />
		<property name="suffix" value=".ftl" />
		<property name="contentType" value="text/html;charset=UTF-8"></property>
		<!-- <property name="attributesMap">
			<map>
				<entry key="CC" value-ref="configCenterTag" />
				<entry key="selectorMap" value-ref="selectorTag"/>
				<entry key="LOGON" value-ref="logonTag" /> 
			</map>
		</property> -->
	</bean>
	
	<!-- 为了避免服务器压力, 控制上传文件大小 在2M(2097152KB)之内 -->
	<bean id="multipartResolver"
		class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
		<property name="maxUploadSize" value="2097152" />
		<property name="defaultEncoding" value="GBK" />
	</bean>
	
	<!-- 总错误处理 -->
	<bean id="exceptionResolver" class="org.springframework.web.servlet.handler.SimpleMappingExceptionResolver">
		<property name="defaultErrorView">
			<value>/error/error</value>
		</property>
		<property name="defaultStatusCode">
			<value>500</value>
		</property>
		<property name="warnLogCategory">
			<value>org.springframework.web.servlet.handler.SimpleMappingExceptionResolver</value>
		</property>
	</bean>
	
	<!-- 提供了消息处理的功能 
	<bean id="messageSource"
		class="org.springframework.context.support.ResourceBundleMessageSource">
		<property name="basename" value="ApplicationResource" />
	</bean>
	-->
	
</beans>
